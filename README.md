# MercadoLibre Product API - Jessika Carvajal

API de backend que proporciona todos los datos necesarios para admitir una p√°gina de detalles del art√≠culo, inspirada en MercadoLibre. Desarrollada como soluci√≥n para challenge t√©cnico con enfoque en buenas pr√°cticas de desarrollo backend.

## üéØ Descripci√≥n del Challenge

Esta API est√° dise√±ada para admitir un frontend proporcionando detalles necesarios del producto, siguiendo las mejores pr√°cticas de desarrollo backend. El endpoint principal obtiene detalles completos del producto junto con informaci√≥n relacionada, todo optimizado para una experiencia similar a MercadoLibre.

## üèóÔ∏è Arquitectura del Sistema

### Diagrama de Arquitectura

```mermaid
graph TB
    subgraph "HTTP Layer"
        Client[Client Application]
        Server[Fastify Server]
    end
    
    subgraph "Adapters Layer"
        Controller[ProductController]
        DTO[DTOs & Mappers]
        Validator[Zod Schemas]
    end
    
    subgraph "Application Layer"
        Service[ProductService]
        UC1[GetProductById]
        UC2[SearchProducts]
        UC3[GetRelatedProducts]
    end
    
    subgraph "Domain Layer"
        Product[Product Entity]
        Price[Price VO]
        ProductId[ProductId VO]
        Stock[ProductStock VO]
        Status[ProductStatus VO]
        Errors[Domain Errors]
        IRepo[ProductRepository Interface]
    end
    
    subgraph "Infrastructure Layer"
        JsonRepo[JsonProductRepository]
        FileUtils[FileUtils]
        Container[DI Container]
        JSONFiles[(JSON Files)]
    end
    
    Client -->|HTTP Requests| Server
    Server -->|Route Handling| Controller
    Controller -->|Validation| Validator
    Controller -->|Data Mapping| DTO
    Controller -->|Business Logic| Service
    
    Service -->|Use Cases| UC1
    Service -->|Use Cases| UC2
    Service -->|Use Cases| UC3
    
    UC1 -->|Domain Operations| Product
    UC2 -->|Domain Operations| Product
    UC3 -->|Domain Operations| Product
    
    UC1 -->|Repository Calls| IRepo
    UC2 -->|Repository Calls| IRepo
    UC3 -->|Repository Calls| IRepo
    
    Product -->|Composed of| Price
    Product -->|Composed of| ProductId
    Product -->|Composed of| Stock
    Product -->|Composed of| Status
    
    IRepo -.->|Implementation| JsonRepo
    JsonRepo -->|File Operations| FileUtils
    FileUtils -->|Read/Write| JSONFiles
    
    Container -->|Dependency Injection| Controller
    Container -->|Dependency Injection| Service
    Container -->|Dependency Injection| JsonRepo
    
    Controller -->|Error Handling| Errors
    JsonRepo -->|Domain Errors| Errors
```

### Arquitectura Hexagonal (Ports & Adapters)

- **Domain Layer**: L√≥gica de negocio pura, entidades y value objects
- **Application Layer**: Casos de uso y servicios de aplicaci√≥n
- **Infrastructure Layer**: Implementaciones t√©cnicas (persistencia, logging)
- **Adapters Layer**: Interfaces con el mundo exterior (HTTP, DTOs)

## üì° Endpoints Principales

Base URL: `http://localhost:3000/api/v1`

### 1. Obtener Detalle de Producto (Endpoint Principal)

```http
GET /api/v1/products/{id}
```

**Descripci√≥n**: Endpoint principal que obtiene todos los detalles necesarios de un producto para mostrar la p√°gina de detalles.

**Par√°metros**:
- `id` (string, requerido): ID √∫nico del producto

**Respuesta exitosa (200)**:
```json
{
  "data": {
    "id": "MLU475845508",
    "title": "Google Pixel 8 Pro 128GB Dorado",
    "description": "Dise√±o moderno y funcionalidad excepcional. Compatible con los √∫ltimos est√°ndares.",
    "price": {
      "amount": 417.04,
      "currency": "USD"
    },
    "stock": {
      "quantity": 42,
      "isAvailable": true
    },
    "status": "inactive",
    "categoryId": "CAT_ELECTRONICS_PHONES",
    "createdAt": "2023-10-29T21:46:00.103Z",
    "updatedAt": "2024-05-23T07:59:00.810Z",
    "isAvailable": false
  },
  "statusCode": 200
}
```

### 2. Buscar Productos

```http
GET /api/v1/products?categoryId={categoryId}&limit={limit}&offset={offset}
```

**Descripci√≥n**: Busca productos con filtros opcionales y paginaci√≥n.

**Query Parameters**:
- `categoryId` (string, opcional): Filtrar por categor√≠a
- `limit` (number, opcional): N√∫mero de productos por p√°gina (default: 10)
- `offset` (number, opcional): N√∫mero de productos a saltar (default: 0)

### 3. Productos Relacionados

```http
GET /api/v1/products/{id}/related?limit={limit}
```

**Descripci√≥n**: Obtiene productos relacionados basados en categor√≠a y caracter√≠sticas similares.

**Par√°metros**:
- `id` (string, requerido): ID del producto base
- `limit` (number, opcional): N√∫mero de productos relacionados (1-20, default: 4)

### 4. Health Check

```http
GET /health
```

**Descripci√≥n**: Endpoint para verificar el estado del servidor.

## üõ†Ô∏è Stack Tecnol√≥gico

### Backend Framework
- **Fastify**: Framework web r√°pido y eficiente para Node.js
  - Validaci√≥n autom√°tica con JSON Schema
  - Serializaci√≥n optimizada
  - Plugin ecosystem robusto
  - Logging integrado con Pino

### Lenguaje y Tipado
- **TypeScript**: Desarrollo con tipos est√°ticos
  - Mejor experiencia de desarrollo
  - Detecci√≥n temprana de errores
  - IntelliSense avanzado
  - Refactoring seguro

### Persistencia
- **Archivos JSON**: Persistencia local sin base de datos
  - `data/products.json`: Base de datos principal de productos
  - `data/categories.json`: Cat√°logo de categor√≠as
  - **FileUtils**: Utilidades para operaciones de archivo seguras

### Testing
- **Vitest**: Framework de testing moderno
  - Tests unitarios comprehensivos
  - Cobertura de c√≥digo
  - Mocking avanzado
  - Integraci√≥n con TypeScript

### Validaci√≥n y Schemas
- **Zod**: Validaci√≥n de esquemas TypeScript-first
  - Validaci√≥n de request/response
  - Type inference autom√°tico
  - Error messages descriptivos

### Calidad de C√≥digo
- **ESLint**: Linting con reglas personalizadas
- **Prettier**: Formateo autom√°tico de c√≥digo
- **TypeScript Compiler**: Verificaci√≥n de tipos est√°tica

## üèÉ‚Äç‚ôÇÔ∏è Inicio R√°pido

### Prerrequisitos
- Node.js >= 18.0.0
- npm

### Instalaci√≥n
```bash
# Clonar repositorio
git clone <repository-url>
cd meli-test

# Instalar dependencias
npm install

# Generar datos de prueba
npm run seed

# Iniciar en modo desarrollo
npm run dev
```

La API estar√° disponible en: `http://localhost:3000`

### Verificaci√≥n
```bash
# Health check
curl http://localhost:3000/health

# Obtener producto
curl http://localhost:3000/api/v1/products/MLU475845508
```

## üìã Scripts Disponibles

- `npm run dev` - Servidor en modo desarrollo con recarga autom√°tica
- `npm run build` - Compilar TypeScript a JavaScript
- `npm start` - Servidor en modo producci√≥n
- `npm run seed` - Generar datos de prueba
- `npm run seed:clean` - Limpiar datos de prueba
- `npm test` - Ejecutar suite de pruebas
- `npm run test:coverage` - Pruebas con reporte de cobertura
- `npm run test:watch` - Pruebas en modo watch
- `npm run lint` - Ejecutar linter
- `npm run format:fix` - Formatear c√≥digo
- `npm run typecheck` - Verificar tipos TypeScript

## üîß Decisiones Arquitect√≥nicas Clave

### 1. Arquitectura Hexagonal
**Decisi√≥n**: Implementar arquitectura hexagonal con separaci√≥n clara de capas.

**Raz√≥n**: 
- Testabilidad: Permite testing aislado de cada capa
- Mantenibilidad: Cambios en infraestructura no afectan dominio
- Escalabilidad: F√°cil intercambio de implementaciones
- Claridad: Separaci√≥n expl√≠cita de responsabilidades

### 2. Persistencia en JSON
**Decisi√≥n**: Usar archivos JSON en lugar de base de datos.

**Raz√≥n**:
- Requerimiento espec√≠fico del challenge
- Simplicidad de setup y deployment
- Ideal para prototipado y demos
- F√°cil inspecci√≥n y debugging

### 3. Validaci√≥n con Zod
**Decisi√≥n**: Usar Zod para validaci√≥n en lugar de JSON Schema puro.

**Raz√≥n**:
- Type-safety autom√°tico con TypeScript
- Mejor experiencia de desarrollo
- Mensajes de error m√°s descriptivos
- Integraci√≥n perfecta con el ecosystem TypeScript

### 4. Fastify sobre Express
**Decisi√≥n**: Elegir Fastify como framework web.

**Raz√≥n**:
- Performance superior
- Validaci√≥n autom√°tica built-in
- Plugin architecture
- Logging integrado optimizado
- TypeScript support nativo

### 5. Value Objects en Domain
**Decisi√≥n**: Implementar Price, ProductId, Stock como Value Objects.

**Raz√≥n**:
- Encapsulaci√≥n de l√≥gica de validaci√≥n
- Inmutabilidad garantizada
- Expresividad del modelo de dominio
- Prevenci√≥n de primitive obsession

## üöÄ Caracter√≠sticas Destacadas

### Manejo de Errores Robusto
- **Errores de Dominio**: `ProductNotFoundError`, `InvalidSearchParamsError`
- **Error Handler Global**: Captura y formatea errores consistentemente
- **Status Codes Apropiados**: HTTP status codes sem√°nticamente correctos
- **Logging Estructurado**: Logs detallados para debugging

### Performance Optimizada
- **B√∫squedas Eficientes**: Algoritmos optimizados para archivos JSON
- **Caching Estrat√©gico**: Cache en memoria para datos frecuentemente accedidos
- **Paginaci√≥n**: Evita cargar datasets completos
- **Lazy Loading**: Carga datos solo cuando es necesario

### Testing Comprehensivo
- **Cobertura > 90%**: Tests unitarios extensivos
- **Test Doubles**: Mocks y stubs para aislamiento
- **Edge Cases**: Cobertura de casos l√≠mite y errores
- **Integration Tests**: Tests de flujo completo

### Developer Experience
- **TypeScript Everywhere**: Type safety en todo el codebase
- **Hot Reload**: Desarrollo con recarga autom√°tica
- **Logging Detallado**: Informaci√≥n completa para debugging
- **Scripts Convenientes**: Comandos para todas las tareas comunes

## üìö Documentaci√≥n Adicional

- **[run.md](./run.md)**: Instrucciones detalladas de ejecuci√≥n
- **[prompts.md](./prompts.md)**: Documentaci√≥n del uso de herramientas AI
- **[postman_collection.json](./postman_collection.json)**: Colecci√≥n de Postman con todos los endpoints
- **[postman_environment.json](./postman_environment.json)**: Variables de entorno para Postman

## üîß Testing con Postman

### Endpoints Incluidos

- ‚úÖ **Health Check** - Verificar estado del servidor
- ‚úÖ **Obtener Producto** - Detalle completo con tests automatizados
- ‚úÖ **Buscar Productos** - Con paginaci√≥n y filtros
- ‚úÖ **Buscar por Categor√≠a** - Filtros espec√≠ficos
- ‚úÖ **Productos Relacionados** - Algoritmo de recomendaci√≥n
- ‚úÖ **Casos de Error** - Manejo de errores 400/404/500

### Tests Automatizados

Cada endpoint incluye tests automatizados que verifican:
- Status codes correctos
- Estructura de respuesta
- Validaci√≥n de datos
- Casos de error
- L√≠mites y validaciones

## üß™ Testing

### Ejecutar Tests
```bash
# Todos los tests
npm test

# Con cobertura
npm run test:coverage

# Modo watch
npm run test:watch

# UI interactiva
npm run test:ui
```